FROM golang:latest

ARG BM_ROOT_DIR
ARG BM_CLI_CLIENT_CONFIG
ARG BM_CLI_CLIENT_ARGS

ENV BM_CLI_CLIENT_CONFIG=${BM_CLI_CLIENT_CONFIG}
ENV BM_ROOT_DIR=/app
ENV BM_CLI_CLIENT_ARGS=${BM_CLI_CLIENT_ARGS}

WORKDIR /app

COPY . .

RUN echo "BM_CLI_CLIENT_ARGS: ${BM_CLI_CLIENT_ARGS}" && go build -o cliclient ./cmd/cli-client/main.go

CMD /app/cliclient ${BM_CLI_CLIENT_ARGS}
