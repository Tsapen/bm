FROM golang:latest

ARG BM_ROOT_DIR
ARG BM_SERVER_CONFIG
ARG BM_HTTP_CLIENT_CONFIG
ARG BM_MIGRATIONS_PATH

ENV BM_ROOT_DIR=/app
ENV BM_SERVER_CONFIG=${BM_TEST_SERVER_CONFIG}
ENV BM_HTTP_CLIENT_CONFIG=${BM_TEST_HTTP_CLIENT_CONFIG}
ENV BM_MIGRATIONS_PATH=${BM_TEST_MIGRATIONS_PATH}

WORKDIR /app

COPY . .

CMD ["go", "test", "./..."]
